!function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(o,i,function(t){return e[t]}.bind(null,i));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=n(1),r=n(2);new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.shortLinks=[],this.inp=document.querySelector(".big-link"),this.router=new i.Router,this.links=[],this.register=new r.Register(!1),this.init(),this.getLink(),this.regBut(),this.logBut(),window.addEventListener("checkRegister",this.checkRegister.bind(this)),this.pages=document.querySelectorAll(".page")}return o(e,[{key:"init",value:function(){var e=this;fetch("http://localhost:3006/links",{headers:{"Content-Type":"application/json"}}).then(function(e){return e.json()}).then(function(t){e.links=t,e.initRoutes(),console.log(e.links),window.dispatchEvent(new HashChangeEvent("hashchange"))})}},{key:"getLink",value:function(){var e=this;document.querySelector(".submit").addEventListener("click",function(t){t.preventDefault(),e.inp.value?e.sendData(e.inp.value):e.renderInputError()})}},{key:"renderInputError",value:function(){console.log("Ошибка, Вы не ввели ссылку")}},{key:"sendData",value:function(e){var t=this;console.log(e),fetch("http://localhost:3006/links",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({source:e})}).then(function(e){return 201!==e.status&&console.log("Post ERROR"),e.json()}).then(function(e){t.shortLink(e)})}},{key:"shortLink",value:function(e){var t="pil/"+e.id;this.shortLinks.push(t),this.renderLinks(t),console.log(e)}},{key:"renderLinks",value:function(e){var t=document.querySelector(".result"),n=document.createElement("a");console.log(this.inp.value),n.setAttribute("href",this.inp.value),n.innerHTML="Ваша короткая ссылка: "+e+" ; Исходная ссылка: "+this.inp.value+" <br>",t.appendChild(n),this.inp.value=""}},{key:"initRoutes",value:function(){this.router.addRoute("",this.renderHomePage.bind(this)),this.router.addRoute("#about",this.renderAboutPage.bind(this)),this.router.addRoute("#main",this.renderMainPage.bind(this)),this.router.addRoute("404",this.renderErrorPage.bind(this))}},{key:"renderHomePage",value:function(){this.pages.forEach(function(e){console.log(e),e.classList.remove("visible")});var e=document.querySelector(".home");console.log(e),e.classList.add("visible"),window.location.hash=""}},{key:"renderAboutPage",value:function(){this.pages.forEach(function(e){console.log(e),e.classList.remove("visible")});var e=document.querySelector(".about");console.log(e),e.classList.add("visible"),window.location.hash="#about"}},{key:"renderMainPage",value:function(){console.log(this.pages),this.pages.forEach(function(e){console.log(e),e.classList.remove("visible")}),document.querySelector(".main").classList.add("visible"),window.location.hash="#main"}},{key:"renderErrorPage",value:function(){this.pages.forEach(function(e){console.log(e),e.classList.remove("visible")}),document.querySelector(".error").classList.add("visible"),window.location.hash="#error"}},{key:"regBut",value:function(){var e=this;document.querySelector(".registration").addEventListener("click",function(){e.renderAboutPage(),history.pushState({},"about","#about"),window.dispatchEvent(new HashChangeEvent("hashchange"))})}},{key:"logBut",value:function(){var e=this;document.querySelector(".login").addEventListener("click",function(){e.renderMainPage(),history.pushState({},"main","#main"),window.dispatchEvent(new HashChangeEvent("hashchange"))})}},{key:"checkRegister",value:function(){this.register.isRegistered?(console.log(1),this.renderMainPage()):console.log("Ошибка регистрации")}}]),e}())},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();t.Router=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.routes={404:function(){console.log("Not found")}},this.mainContentPages=document.querySelectorAll(".page"),window.addEventListener("hashchange",function(e){t.render(decodeURI(window.location.hash))})}return o(e,[{key:"addRoute",value:function(e,t){this.routes[e]=t}},{key:"render",value:function(e){var t=e.split("/")[0];console.log(t),[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(this.mainContentPages)).forEach(function(e){e.classList.remove("visible")}),this.routes[t]?this.routes[t]():this.routes[404]()}}]),e}()},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();t.Register=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.isRegistered=t,this.checkLogin()}return o(e,[{key:"checkLogin",value:function(){var e=this,t=document.querySelector(".registration-submit"),n=document.querySelector(".registration-login"),o=[];fetch("http://localhost:3006/users",{headers:{"Content-Type":"application/json"}}).then(function(e){return e.json()}).then(function(e){e.forEach(function(e){o.push(e.login)})}),t.addEventListener("click",function(t){(t.preventDefault(),n.value)?o.some(function(e){return e==n.value})?e.repeatLogin():e.checkPassword(n.value):console.log("Поле пустое")})}},{key:"checkPassword",value:function(e){var t=document.querySelector(".registration-password"),n=document.querySelector(".registration-password-check");t.value&&n.value?t.value==n.value?this.sendRegistration(e,t.value):this.failedRegistration(n):console.log("Поля с паролем не заполнены"),console.log("checkpassword")}},{key:"repeatLogin",value:function(){console.log("Repeat login")}},{key:"sendRegistration",value:function(e,t){console.log("Регистрация прошла успешно"),fetch("http://localhost:3006/users",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({login:e,password:t})}).then(function(e){return 201!==e.status&&console.log("Post ERROR"),e.json()}).then(function(e){console.log(e)}),this.isRegistered=!0,localStorage.setItem("login",e);var n=new Event("checkRegister");window.dispatchEvent(n)}},{key:"failedRegistration",value:function(e){e.value="",console.log("Пароли не совпадают. Попробуйте еще")}}]),e}()}]);
//# sourceMappingURL=bundle.js.map